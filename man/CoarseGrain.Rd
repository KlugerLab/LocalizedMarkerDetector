% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_lmds.R
\name{CoarseGrain}
\alias{CoarseGrain}
\title{Cell graph coarse graining}
\usage{
CoarseGrain(
  feature_space,
  expression,
  graph.affinity,
  N = 5000,
  random.seed = 1
)
}
\arguments{
\item{feature_space}{matrix; the low-dimensional feature space of cells (e.g., PCA or UMAP coordinates), with cells as rows and dimensions as columns.}

\item{expression}{matrix; the gene expression matrix with features (genes) as rows and cells as columns.}

\item{graph.affinity}{matrix; the cell-cell affinity matrix to be coarse-grained.}

\item{N}{integer; the number of coarse-grained groups to form using k-means clustering. Default is 5000.}

\item{random.seed}{integer; random seed to ensure reproducibility. Default is 1.}
}
\value{
A list containing:
\item{expression}{matrix; coarse-grained gene expression matrix (genes Ã— groups).}
\item{graph}{matrix; updated cell-cell affinity matrix between coarse-grained groups.}
}
\description{
Aggregates cells into coarse-grained groups using k-means clustering, and updates the gene expression matrix and cell-cell affinity matrix accordingly.
This is useful for testing or reducing computational complexity in downstream analyses.
}
